function getHtml(e){return new Promise(((t,n)=>{const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(4===o.readyState)switch(o.status){case 200:case 0:try{const e=(new DOMParser).parseFromString(o.responseText,"text/html");t(e)}catch(e){n(e)}break;default:n(o)}},o.onerror=n,o.open("GET",e,!1),o.send()}))}function appendNode(e,t,n){if("SCRIPT"!==t.tagName)return void e.appendChild(t);const o=document.createElement("script"),c=t.outerHTML;if(c&&!t.text){const e=c.indexOf("src=")+5,t=c.indexOf(">"),i=c.substr(e,t-e-1);if(n&&""!=n){const e=i.split("/");o.src=n+e[e.length-1]}else o.src=i}t.type&&(o.type=t.type),o.async=!1,o.innerHTML=t.innerHTML,t.parentElement.removeChild(t),e.appendChild(o)}function injectApp(e,t,n){return getHtml(e+t).then((e=>{for(;e.head.children.length;)appendNode(document.head,e.head.children[0],n);for(;e.body.children.length;)appendNode(document.body,e.body.children[0],n)}))}function setVersion(e){window.__appVersion=e}function runInjector(){let e="";const t=new URL(location.href).search.indexOf("remote=true")>=0,n=location.href.indexOf("localhost:8080")<0||t;let o=location.href,c="current";if(n){const t=localStorage.getItem("DTAG_STORAGE_REMOTE_BUILDNO");t&&(c=t),"local"!=c.toLowerCase()&&(o="https://cto-tvd.github.io/smarttvweb/"+c+"/",e=o)}const i=new URL(o),r=(i.origin+i.pathname).replace(/index\.html$/,"");window.__appLocation=r;const s="content.html";injectApp(r,s,e).then((()=>{n?(setVersion("Remote "+c),console.info("[index] remote content.html successfully injected ...")):(setVersion("Local"),console.info("[index] local content.html successfully injected ..."))})).catch((e=>{setVersion("Local"),console.info("[index] error at content.html injection ...",e);const t=new URL(location.href),n=(t.origin+t.pathname).replace(/index\.html$/,"");window.__appLocation=n,injectApp("",s).then((()=>console.info("[index] local content.html successfully injected ..."))).catch((e=>console.info("[index] error at local content.html injection ...",e)))}))}